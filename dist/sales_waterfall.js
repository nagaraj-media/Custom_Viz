function nFormatter(e){return(e=e>=0?e:Math.abs(e))>=1e9?(e/1e9).toFixed(1)+"B":e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e>0?e.toFixed(1):e}!function(){var e={id:"highcharts_waterfall",label:"Waterfall",create:function(e,l){e.innerHTML='\n          <style>\n              .remove-me {\n              }\n              .looker-waterfall-chart {\n                  height: 100%;\n                  width: 100%;\n              }\n          </style>\n          <div id="looker-waterfall-chart" class="looker-waterfall-chart"></div>\n      '},update:function(e,l,a,t){t.fields.measure_like;for(var i,n=0,r=[],o=t.fields.measure_like.length,s=0;s<o/2;s++){let l=e[0][t.fields.measure_like[s].name].links;var d,u=t.fields.measure_like[s].label_short,m=e[0][t.fields.measure_like[s].name].value;d="Won"==u?"#81eb99":"Lost"==u?"#F7968D":"#FED8A0",i={name:u+"\n("+e[0][t.fields.measure_like[s+o/2].name].value+")",y:m,events:{click:function(e){window.LookerCharts.Utils.openDrillMenu({links:l,event:e})}},color:d},n+=e[0][t.fields.measure_like[s].name].value>0?e[0][t.fields.measure_like[s].name].value:0,r.push(i)}Highcharts.setOptions({lang:{thousandsSep:","}}),console.log(n);var f=Highcharts.chart("looker-waterfall-chart",{colors:a.color_range,chart:{type:"waterfall"},credits:!1,title:{text:null},exporting:{enabled:!1},xAxis:{type:"category"},yAxis:{min:0,visible:!1},legend:{enabled:!1},tooltip:{formatter:function(){return"$"+nFormatter(this.y)}},plotOptions:{waterfall:{borderColor:"#FFFFFF",dataLabels:{style:{color:"#000000",textOutline:"0px contrast",fontFamily:"Open Sans"}}}},series:[{upColor:"#98FFAE",color:"red",data:r,pointPadding:0,dataLabels:{enabled:!0,formatter:function(){return"$"+nFormatter(this.y)}}}]});a.dotted_line&&f.yAxis[0].addPlotLine({value:n,color:"green",dashStyle:"shortdash",width:2,visible:a.dotted_line,label:{text:"Cumulative In Pipeline: $"+nFormatter(n)}}),a.start_end_band&&f.yAxis[0].addPlotBand({from:e[0][t.fields.measure_like[0].name].value,to:-1*e[0][t.fields.measure_like[t.fields.measure_like.length-1].name].value,color:"#FCFFC5",id:"plot-band-1",label:{text:"Amount Changed: $"+nFormatter(e[0][t.fields.measure_like[0].name].value+e[0][t.fields.measure_like[t.fields.measure_like.length-1].name].value),verticalAlign:"middle",align:"center"}})}};looker.plugins.visualizations.add(e)}();